<html>

<head>
    <title>Minimum UI Demo </title>
	
	<style>

#simulatorAtoP {
        border: 0px line;
        width: 100%;
        height: 100%;
		overflow-y:scroll;
		overflow-x:scroll;
    }

	</style
</head>
<body>
<script type="text/javascript">
 if (typeof window !== 'undefined') {
 // Perform sessionStorage action
 const item = sessionStorage.getItem('key')
 }
var iframeSize = '';
</script>

<script type="text/javascript">
function myDelay(n) {  
  n = n || 2000;
  console.log('... myDelay()');
  return new Promise(done => {
    setTimeout(() => {
      done();
    }, n);
  });
}
</script>

<script type="text/javascript">
 async function loadInfo(newEventData) {
   // can message back using event.source.postMessage(...)
  var newURL = '';
  var iframeID = '';
  try {
    var newURL = '';
    var iframeID = '';
    //console.log("**** loadInfo(): libretexts data :", newEventData);
	//await myDelay(1000);
    JSONdata = JSON.parse(newEventData);
    newRT = JSONdata.m_RT;
    newSS = JSONdata.m_SS;
    staticRun = JSONdata.m_static;
    parSliders = JSONdata.m_pars;
    spPlot = JSONdata.m_species;
    newURL = JSONdata.m_URL;
    iframeID = JSONdata.m_iframeID;
	yLabel = JSONdata.m_yLabel;
	xLabel = JSONdata.m_xLabel;
    console.log('loadInfo(): newURL: ', newURL);
	runModel2(newURL, iframeID);
	}
  catch(err) {
     console.log('loadInfo: message error: ', err);
	// window.alert('Model information not received!');
   
   }
  
  return;

} 
</script>

<script type="text/javascript">
window.addEventListener('message',function (event) {
  // Note: This gets called twice (Not sure why), first time JSON data not loaded. 
  if (event.origin != 'https://bio.libretexts.org') {
    // something from an unknown domain, ignore it
	console.log("*****Unknown data :", event.data);
    return;
  }
 // console.log('EventListener called *** ');
 
  try {
    loadInfo(event.data);
 	}
  catch(err) {
     console.log('eventListener: message error: ', err);
   }
  //runModel2(newURL, iframeID);
} );
</script>


 <p>
 <script type="text/javascript">
 // This is the data that needs to be populated.
var newModel = ""; // SBML model in XML format. Some ways of populating string listed below.
var newRT = '';  // Length of run
var newSS = ''; // integrator step size, thus 1000 points (10/0.010)
var staticRun = 'true'; // Display after all calculations are done.
var parSliders = ''; // param sliders, exact id match
var spPlot = ''; // Species to plot, exact id match
var yLabel = 'conc (uM)';
var xLabel = 'sec';
</script>

 </p>
 
 <script type="text/javascript">
 function getInfo2(frame,model,rt, ss,static,pars,sp) {
   console.log(' *** getInfo2() loaded.');
   sessionStorage.setItem("MODEL", model);
   sessionStorage.setItem('RUNTIME', rt);
   sessionStorage.setItem('STEPSIZE', ss);
   sessionStorage.setItem('STATIC', static);
   sessionStorage.setItem('SLIDERS', pars);
   sessionStorage.setItem('PLOT_SPECIES', sp);
   sessionStorage.setItem('X_LABEL', xLabel);
   sessionStorage.setItem('Y_LABEL', yLabel);
   window.location.href = ('Debug/index.html?')
  // document.getElementById(frame).src = "Debug/index.html?"; // Location of miniSidewinder
 }
 </script> 

<script type="text/javascript">
function runModel2(modelURL, newFrameID) {
// Use this code if you have a predefined model to run located at some URL:
newModel = "libretexts/models/AtoP_Rev_Uncatalyzed.xml"; // SBML model in XML format. Some ways of populating string listed below.
console.log('** runModel2() loaded');
//fetch('http://localhost/models/simpleRXN.xml')
//fetch('models/BIOMD0098_Goldbeter1990.xml')
fetch(newModel)
  .then(response => response.text())
  .then((data) => {
    console.log(data);
	//newModel = data;
// 	yLabel = 'conc (uM)';
// 	xLabel = 'sec';
	getInfo2(newFrameID,data,newRT,newSS,staticRun,parSliders,spPlot);
  })
  
 }
// END of predefined model code.
</script>

<script type="text/javascript">
 //runModel2();
 console.log(" * AtoP_Rev...html file loaded......");
</script>  
  
</body>

</html>

